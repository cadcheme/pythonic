<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <link href="https://gavinw.me/pythonic/rss.xml" rel="alternate" type="application/rss+xml" title="RSS">
    <link href="https://gavinw.me/pythonic/styles.css" rel="stylesheet">
    <title>Pythonic</title>
</head>
<body>
<div class="container">
    
<div class="row">
<div class="col">
    <h1>Update page with Ajax</h1>
    
        <h6>November  1, 2022</h6>
    
    <hr>
    <p>This Flask webapp example uses Ajax to update the page with results from the post request. The results are returned as JSON which is used to update the div tags.</p>
<p><img src="/pythonic/img/flask-ajax.png" style="max-width:100%;" alt="flask ajax"></p>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#65737e;"># app.py
</span><span>
</span><span style="color:#b48ead;">from </span><span>flask </span><span style="color:#b48ead;">import </span><span>Flask
</span><span style="color:#b48ead;">from </span><span>flask </span><span style="color:#b48ead;">import </span><span>render_template
</span><span style="color:#b48ead;">from </span><span>flask </span><span style="color:#b48ead;">import </span><span>request
</span><span style="color:#b48ead;">from </span><span>flask </span><span style="color:#b48ead;">import </span><span>jsonify
</span><span>
</span><span>app = </span><span style="color:#bf616a;">Flask</span><span>(__name__)
</span><span>
</span><span>
</span><span>@app.</span><span style="color:#bf616a;">route</span><span>(&#39;</span><span style="color:#a3be8c;">/</span><span>&#39;)
</span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">index</span><span>():
</span><span>    </span><span style="color:#b48ead;">return </span><span style="color:#bf616a;">render_template</span><span>(&#39;</span><span style="color:#a3be8c;">index.html</span><span>&#39;)
</span><span>
</span><span>
</span><span>@app.</span><span style="color:#bf616a;">route</span><span>(&#39;</span><span style="color:#a3be8c;">/results</span><span>&#39;, </span><span style="color:#bf616a;">methods</span><span>=[&#39;</span><span style="color:#a3be8c;">POST</span><span>&#39;])
</span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">results</span><span>():
</span><span>    a = </span><span style="color:#bf616a;">float</span><span>(request.form[&#39;</span><span style="color:#a3be8c;">numberA</span><span>&#39;])
</span><span>    b = </span><span style="color:#bf616a;">float</span><span>(request.form[&#39;</span><span style="color:#a3be8c;">numberB</span><span>&#39;])
</span><span>
</span><span>    sum_ab = a + b
</span><span>    mult_ab = a * b
</span><span>    div_ab = a / b
</span><span>
</span><span>    res = {
</span><span>        &#39;</span><span style="color:#a3be8c;">a</span><span>&#39;: a,
</span><span>        &#39;</span><span style="color:#a3be8c;">b</span><span>&#39;: b,
</span><span>        &#39;</span><span style="color:#a3be8c;">sum_ab</span><span>&#39;: sum_ab,
</span><span>        &#39;</span><span style="color:#a3be8c;">mult_ab</span><span>&#39;: mult_ab,
</span><span>        &#39;</span><span style="color:#a3be8c;">div_ab</span><span>&#39;: div_ab
</span><span>    }
</span><span>
</span><span>    </span><span style="color:#b48ead;">return </span><span style="color:#bf616a;">jsonify</span><span>(res)
</span></code></pre>
<pre data-lang="html" style="background-color:#2b303b;color:#c0c5ce;" class="language-html "><code class="language-html" data-lang="html"><span style="color:#65737e;">&lt;!-- templates/index.html --&gt;
</span><span>
</span><span>&lt;!</span><span style="color:#b48ead;">DOCTYPE </span><span style="color:#d08770;">html</span><span>&gt;
</span><span>&lt;</span><span style="color:#bf616a;">html </span><span style="color:#d08770;">lang</span><span>=&quot;</span><span style="color:#a3be8c;">en</span><span>&quot;&gt;
</span><span>&lt;</span><span style="color:#bf616a;">head</span><span>&gt;
</span><span>    &lt;</span><span style="color:#bf616a;">meta </span><span style="color:#d08770;">charset</span><span>=&quot;</span><span style="color:#a3be8c;">utf-8</span><span>&quot;&gt;
</span><span>    &lt;</span><span style="color:#bf616a;">meta </span><span style="color:#d08770;">name</span><span>=&quot;</span><span style="color:#a3be8c;">viewport</span><span>&quot; </span><span style="color:#d08770;">content</span><span>=&quot;</span><span style="color:#a3be8c;">width=device-width, initial-scale=1</span><span>&quot;&gt;
</span><span>    &lt;</span><span style="color:#bf616a;">link </span><span style="color:#d08770;">href</span><span>=&quot;</span><span style="color:#a3be8c;">https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css</span><span>&quot; </span><span style="color:#d08770;">rel</span><span>=&quot;</span><span style="color:#a3be8c;">stylesheet</span><span>&quot; </span><span style="color:#d08770;">integrity</span><span>=&quot;</span><span style="color:#a3be8c;">sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6</span><span>&quot; </span><span style="color:#d08770;">crossorigin</span><span>=&quot;</span><span style="color:#a3be8c;">anonymous</span><span>&quot;&gt;
</span><span>    &lt;</span><span style="color:#bf616a;">script </span><span style="color:#d08770;">src</span><span>=&quot;</span><span style="color:#a3be8c;">https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js</span><span>&quot; </span><span style="color:#d08770;">integrity</span><span>=&quot;</span><span style="color:#a3be8c;">sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==</span><span>&quot; </span><span style="color:#d08770;">crossorigin</span><span>=&quot;</span><span style="color:#a3be8c;">anonymous</span><span>&quot; </span><span style="color:#d08770;">referrerpolicy</span><span>=&quot;</span><span style="color:#a3be8c;">no-referrer</span><span>&quot;&gt;&lt;/</span><span style="color:#bf616a;">script</span><span>&gt;
</span><span>
</span><span>    &lt;</span><span style="color:#bf616a;">title</span><span>&gt;Home Page&lt;/</span><span style="color:#bf616a;">title</span><span>&gt;
</span><span>
</span><span>    &lt;</span><span style="color:#bf616a;">style </span><span style="color:#d08770;">type</span><span>=&quot;</span><span style="color:#a3be8c;">text/css</span><span>&quot;&gt;
</span><span>        </span><span style="color:#bf616a;">body </span><span>{ background-color: lightgray; }
</span><span>        </span><span style="color:#bf616a;">input </span><span>{ max-width: </span><span style="color:#d08770;">200px</span><span>; }
</span><span>    &lt;/</span><span style="color:#bf616a;">style</span><span>&gt;
</span><span>&lt;/</span><span style="color:#bf616a;">head</span><span>&gt;
</span><span>&lt;</span><span style="color:#bf616a;">body</span><span>&gt;
</span><span>    &lt;</span><span style="color:#bf616a;">div </span><span style="color:#d08770;">class</span><span>=&quot;</span><span style="color:#a3be8c;">container</span><span>&quot;&gt;
</span><span>        &lt;</span><span style="color:#bf616a;">div </span><span style="color:#d08770;">class</span><span>=&quot;</span><span style="color:#a3be8c;">row</span><span>&quot;&gt;
</span><span>            &lt;</span><span style="color:#bf616a;">div </span><span style="color:#d08770;">class</span><span>=&quot;</span><span style="color:#a3be8c;">col</span><span>&quot;&gt;
</span><span>
</span><span>                &lt;</span><span style="color:#bf616a;">h1 </span><span style="color:#d08770;">class</span><span>=&quot;</span><span style="color:#a3be8c;">mt-3</span><span>&quot;&gt;Submit numbers&lt;/</span><span style="color:#bf616a;">h1</span><span>&gt;
</span><span>
</span><span>                &lt;</span><span style="color:#bf616a;">p</span><span>&gt;Input numbers A and B into the form below then click the Submit button to see the results.&lt;/</span><span style="color:#bf616a;">p</span><span>&gt;
</span><span>
</span><span>                &lt;</span><span style="color:#bf616a;">h2</span><span>&gt;Form&lt;/</span><span style="color:#bf616a;">h2</span><span>&gt;
</span><span>                &lt;</span><span style="color:#bf616a;">form </span><span style="color:#d08770;">action</span><span>=&quot;</span><span style="color:#a3be8c;">/results</span><span>&quot; </span><span style="color:#d08770;">method</span><span>=&quot;</span><span style="color:#a3be8c;">POST</span><span>&quot;&gt;
</span><span>                    &lt;</span><span style="color:#bf616a;">div </span><span style="color:#d08770;">class</span><span>=&quot;</span><span style="color:#a3be8c;">mb-3</span><span>&quot;&gt;
</span><span>                        &lt;</span><span style="color:#bf616a;">label </span><span style="color:#d08770;">for</span><span>=&quot;</span><span style="color:#a3be8c;">numberA</span><span>&quot; </span><span style="color:#d08770;">class</span><span>=&quot;</span><span style="color:#a3be8c;">form-label</span><span>&quot;&gt;Number A&lt;/</span><span style="color:#bf616a;">label</span><span>&gt;
</span><span>                        &lt;</span><span style="color:#bf616a;">input </span><span style="color:#d08770;">type</span><span>=&quot;</span><span style="color:#a3be8c;">number</span><span>&quot; </span><span style="color:#d08770;">step</span><span>=&quot;</span><span style="color:#a3be8c;">any</span><span>&quot; </span><span style="color:#d08770;">class</span><span>=&quot;</span><span style="color:#a3be8c;">form-control</span><span>&quot; </span><span style="color:#d08770;">name</span><span>=&quot;</span><span style="color:#a3be8c;">numberA</span><span>&quot;&gt;
</span><span>                    &lt;/</span><span style="color:#bf616a;">div</span><span>&gt;
</span><span>                    &lt;</span><span style="color:#bf616a;">div </span><span style="color:#d08770;">class</span><span>=&quot;</span><span style="color:#a3be8c;">mb-3</span><span>&quot;&gt;
</span><span>                        &lt;</span><span style="color:#bf616a;">label </span><span style="color:#d08770;">for</span><span>=&quot;</span><span style="color:#a3be8c;">numberB</span><span>&quot; </span><span style="color:#d08770;">class</span><span>=&quot;</span><span style="color:#a3be8c;">form-label</span><span>&quot;&gt;Number B&lt;/</span><span style="color:#bf616a;">label</span><span>&gt;
</span><span>                        &lt;</span><span style="color:#bf616a;">input </span><span style="color:#d08770;">type</span><span>=&quot;</span><span style="color:#a3be8c;">number</span><span>&quot; </span><span style="color:#d08770;">step</span><span>=&quot;</span><span style="color:#a3be8c;">any</span><span>&quot; </span><span style="color:#d08770;">class</span><span>=&quot;</span><span style="color:#a3be8c;">form-control</span><span>&quot; </span><span style="color:#d08770;">name</span><span>=&quot;</span><span style="color:#a3be8c;">numberB</span><span>&quot;&gt;
</span><span>                    &lt;/</span><span style="color:#bf616a;">div</span><span>&gt;
</span><span>                    &lt;</span><span style="color:#bf616a;">button </span><span style="color:#d08770;">type</span><span>=&quot;</span><span style="color:#a3be8c;">submit</span><span>&quot; </span><span style="color:#d08770;">class</span><span>=&quot;</span><span style="color:#a3be8c;">btn btn-primary</span><span>&quot;&gt;Submit&lt;/</span><span style="color:#bf616a;">button</span><span>&gt;
</span><span>                &lt;/</span><span style="color:#bf616a;">form</span><span>&gt;
</span><span>
</span><span>                &lt;</span><span style="color:#bf616a;">br</span><span>&gt;
</span><span>                &lt;</span><span style="color:#bf616a;">div </span><span style="color:#8fa1b3;">id</span><span>=&quot;</span><span style="color:#a3be8c;">numA</span><span>&quot;&gt;&lt;/</span><span style="color:#bf616a;">div</span><span>&gt;
</span><span>                &lt;</span><span style="color:#bf616a;">div </span><span style="color:#8fa1b3;">id</span><span>=&quot;</span><span style="color:#a3be8c;">numB</span><span>&quot;&gt;&lt;/</span><span style="color:#bf616a;">div</span><span>&gt;
</span><span>                &lt;</span><span style="color:#bf616a;">div </span><span style="color:#8fa1b3;">id</span><span>=&quot;</span><span style="color:#a3be8c;">sumAB</span><span>&quot;&gt;&lt;/</span><span style="color:#bf616a;">div</span><span>&gt;
</span><span>                &lt;</span><span style="color:#bf616a;">div </span><span style="color:#8fa1b3;">id</span><span>=&quot;</span><span style="color:#a3be8c;">multAB</span><span>&quot;&gt;&lt;/</span><span style="color:#bf616a;">div</span><span>&gt;
</span><span>                &lt;</span><span style="color:#bf616a;">div </span><span style="color:#8fa1b3;">id</span><span>=&quot;</span><span style="color:#a3be8c;">divAB</span><span>&quot;&gt;&lt;/</span><span style="color:#bf616a;">div</span><span>&gt;
</span><span>
</span><span>            &lt;/</span><span style="color:#bf616a;">div</span><span>&gt;
</span><span>        &lt;/</span><span style="color:#bf616a;">div</span><span>&gt;
</span><span>    &lt;/</span><span style="color:#bf616a;">div</span><span>&gt;
</span><span>
</span><span>    &lt;</span><span style="color:#bf616a;">script </span><span style="color:#d08770;">type</span><span>=&quot;</span><span style="color:#a3be8c;">text/javascript</span><span>&quot;&gt;
</span><span>        </span><span style="color:#bf616a;">$</span><span>(&quot;</span><span style="color:#a3be8c;">form</span><span>&quot;).</span><span style="color:#bf616a;">submit</span><span>(</span><span style="color:#b48ead;">function</span><span>(event) {
</span><span>
</span><span>            </span><span style="color:#bf616a;">$</span><span>.</span><span style="color:#bf616a;">ajax</span><span>({
</span><span>                method: &quot;</span><span style="color:#a3be8c;">POST</span><span>&quot;,
</span><span>                url: &quot;</span><span style="color:#a3be8c;">/results</span><span>&quot;,
</span><span>                data: {
</span><span>                    numberA: </span><span style="color:#bf616a;">$</span><span>(&quot;</span><span style="color:#a3be8c;">input[name=numberA]</span><span>&quot;).</span><span style="color:#bf616a;">val</span><span>(),
</span><span>                    numberB: </span><span style="color:#bf616a;">$</span><span>(&quot;</span><span style="color:#a3be8c;">input[name=numberB]</span><span>&quot;).</span><span style="color:#bf616a;">val</span><span>()
</span><span>                },
</span><span>                </span><span style="color:#8fa1b3;">success</span><span>: </span><span style="color:#b48ead;">function</span><span>(result) {
</span><span>                    </span><span style="color:#bf616a;">$</span><span>(&quot;</span><span style="color:#a3be8c;">#numA</span><span>&quot;).</span><span style="color:#bf616a;">html</span><span>(&quot;</span><span style="color:#a3be8c;">&lt;p&gt;Number A is </span><span>&quot; + </span><span style="color:#bf616a;">result</span><span>.a + &quot;</span><span style="color:#a3be8c;">&lt;/p&gt;</span><span>&quot;);
</span><span>                    </span><span style="color:#bf616a;">$</span><span>(&quot;</span><span style="color:#a3be8c;">#numB</span><span>&quot;).</span><span style="color:#bf616a;">html</span><span>(&quot;</span><span style="color:#a3be8c;">&lt;p&gt;Number B is </span><span>&quot; + </span><span style="color:#bf616a;">result</span><span>.b + &quot;</span><span style="color:#a3be8c;">&lt;/p&gt;</span><span>&quot;);
</span><span>                    </span><span style="color:#bf616a;">$</span><span>(&quot;</span><span style="color:#a3be8c;">#sumAB</span><span>&quot;).</span><span style="color:#bf616a;">html</span><span>(&quot;</span><span style="color:#a3be8c;">&lt;p&gt;Sum A + B is </span><span>&quot; + </span><span style="color:#bf616a;">result</span><span>.sum_ab + &quot;</span><span style="color:#a3be8c;">&lt;/p&gt;</span><span>&quot;);
</span><span>                    </span><span style="color:#bf616a;">$</span><span>(&quot;</span><span style="color:#a3be8c;">#multAB</span><span>&quot;).</span><span style="color:#bf616a;">html</span><span>(&quot;</span><span style="color:#a3be8c;">&lt;p&gt;Multiply A x B is </span><span>&quot; + </span><span style="color:#bf616a;">result</span><span>.mult_ab + &quot;</span><span style="color:#a3be8c;">&lt;/p&gt;</span><span>&quot;);
</span><span>                    </span><span style="color:#bf616a;">$</span><span>(&quot;</span><span style="color:#a3be8c;">#divAB</span><span>&quot;).</span><span style="color:#bf616a;">html</span><span>(&quot;</span><span style="color:#a3be8c;">&lt;p&gt;Divide A / B is </span><span>&quot; + </span><span style="color:#bf616a;">result</span><span>.div_ab + &quot;</span><span style="color:#a3be8c;">&lt;/p&gt;</span><span>&quot;);
</span><span>                }
</span><span>            });
</span><span>
</span><span>            </span><span style="color:#bf616a;">event</span><span>.</span><span style="color:#bf616a;">preventDefault</span><span>();
</span><span>        });
</span><span>    &lt;/</span><span style="color:#bf616a;">script</span><span>&gt;
</span><span>
</span><span>&lt;/</span><span style="color:#bf616a;">body</span><span>&gt;
</span><span>&lt;/</span><span style="color:#bf616a;">html</span><span>&gt;
</span></code></pre>

</div>
</div>
<div class="row my-5">
<div class="col">
    <p class="text-center small my-5">
        <a href="https://gavinw.me/pythonic/">Pythonic Programming</a> © 2023 <br>
        Built by <a href="https://gavinw.me">Gavin Wiggins</a>
    </p>
</div>
</div>

</div>
</body>
</html>