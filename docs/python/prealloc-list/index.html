<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <link href="https://gavinw.me/pythonic/rss.xml" rel="alternate" type="application/rss+xml" title="RSS">
    <link href="https://gavinw.me/pythonic/styles.css" rel="stylesheet">
    <title>Pythonic</title>
</head>
<body>
<div class="container">
    
<div class="row">
<div class="col">
    <h1>Pre-allocate list</h1>
    
        <h6>November  8, 2022</h6>
    
    <hr>
    <p>If the size of a list is known, then pre-allocating the list can provide
performance improvements; especially for a large list. The example below
measures the performance of appending items to an empty list. Pre-allocating
a list of known size and assigning items to it gives better performance than
appending to the list. The list comprehension approach (see Example 3) gives
the best elapsed time.</p>
<ul>
<li>Example 1 = 11.6552 ms</li>
<li>Example 2 = 8.9583 ms</li>
<li>Example 3 = 4.5061 ms</li>
</ul>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">import </span><span>time
</span><span>
</span><span style="color:#65737e;"># Size of the list
</span><span>n = </span><span style="color:#d08770;">100_000
</span><span>
</span><span style="color:#65737e;"># Example 1. Create an empty list and append items to it.
</span><span style="color:#65737e;"># ----------------------------------------------------------------------------
</span><span>
</span><span>tic = time.</span><span style="color:#bf616a;">perf_counter_ns</span><span>()
</span><span>
</span><span>list_one = []
</span><span>
</span><span style="color:#b48ead;">for </span><span>i </span><span style="color:#b48ead;">in </span><span style="color:#96b5b4;">range</span><span>(n):
</span><span>    list_one.</span><span style="color:#bf616a;">append</span><span>(i)
</span><span>
</span><span>toc = time.</span><span style="color:#bf616a;">perf_counter_ns</span><span>()
</span><span style="color:#96b5b4;">print</span><span>(</span><span style="color:#b48ead;">f</span><span>&#39;</span><span style="color:#a3be8c;">Ex 1 elapsed time </span><span>{(toc - tic) / </span><span style="color:#d08770;">1_000_000:.4f</span><span>}</span><span style="color:#a3be8c;"> ms</span><span>&#39;)
</span><span style="color:#96b5b4;">print</span><span>(</span><span style="color:#b48ead;">f</span><span>&#39;</span><span style="color:#a3be8c;">list_one = </span><span>{list_one[:</span><span style="color:#d08770;">3</span><span>]}</span><span style="color:#a3be8c;">...</span><span>{list_one[-</span><span style="color:#d08770;">3</span><span>:]}</span><span style="color:#96b5b4;">\n</span><span>&#39;)
</span><span>
</span><span style="color:#65737e;"># Example 2. Pre-allocate list of None items then assign items at each index.
</span><span style="color:#65737e;"># ----------------------------------------------------------------------------
</span><span>
</span><span>tic = time.</span><span style="color:#bf616a;">perf_counter_ns</span><span>()
</span><span>
</span><span>list_two = [</span><span style="color:#d08770;">None</span><span>] * n
</span><span>
</span><span style="color:#b48ead;">for </span><span>i </span><span style="color:#b48ead;">in </span><span style="color:#96b5b4;">range</span><span>(n):
</span><span>    list_two[i] = i
</span><span>
</span><span>toc = time.</span><span style="color:#bf616a;">perf_counter_ns</span><span>()
</span><span style="color:#96b5b4;">print</span><span>(</span><span style="color:#b48ead;">f</span><span>&#39;</span><span style="color:#a3be8c;">Ex 2 elapsed time </span><span>{(toc - tic) / </span><span style="color:#d08770;">1_000_000:.4f</span><span>}</span><span style="color:#a3be8c;"> ms</span><span>&#39;)
</span><span style="color:#96b5b4;">print</span><span>(</span><span style="color:#b48ead;">f</span><span>&#39;</span><span style="color:#a3be8c;">list_two = </span><span>{list_two[:</span><span style="color:#d08770;">3</span><span>]}</span><span style="color:#a3be8c;">...</span><span>{list_two[-</span><span style="color:#d08770;">3</span><span>:]}</span><span style="color:#96b5b4;">\n</span><span>&#39;)
</span><span>
</span><span style="color:#65737e;"># Example 3. Pre-allocate list and assign items using list comprehension.
</span><span style="color:#65737e;"># ----------------------------------------------------------------------------
</span><span>
</span><span>tic = time.</span><span style="color:#bf616a;">perf_counter_ns</span><span>()
</span><span>
</span><span>list_three = [i </span><span style="color:#b48ead;">for </span><span>i </span><span style="color:#b48ead;">in </span><span style="color:#96b5b4;">range</span><span>(n)]
</span><span>
</span><span>toc = time.</span><span style="color:#bf616a;">perf_counter_ns</span><span>()
</span><span style="color:#96b5b4;">print</span><span>(</span><span style="color:#b48ead;">f</span><span>&#39;</span><span style="color:#a3be8c;">Ex 3 elapsed time </span><span>{(toc - tic) / </span><span style="color:#d08770;">1_000_000:.4f</span><span>}</span><span style="color:#a3be8c;"> ms</span><span>&#39;)
</span><span style="color:#96b5b4;">print</span><span>(</span><span style="color:#b48ead;">f</span><span>&#39;</span><span style="color:#a3be8c;">list_three = </span><span>{list_three[:</span><span style="color:#d08770;">3</span><span>]}</span><span style="color:#a3be8c;">...</span><span>{list_three[-</span><span style="color:#d08770;">3</span><span>:]}&#39;)
</span></code></pre>

</div>
</div>
<div class="row my-5">
<div class="col">
    <p class="text-center small my-5">
        <a href="https://gavinw.me/pythonic/">Pythonic Programming</a> Â© 2023 <br>
        Built by <a href="https://gavinw.me">Gavin Wiggins</a>
    </p>
</div>
</div>

</div>
</body>
</html>