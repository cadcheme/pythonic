<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <link href="https://gavinw.me/pythonic/rss.xml" rel="alternate" type="application/rss+xml" title="RSS">
    <link href="https://gavinw.me/pythonic/styles.css" rel="stylesheet">
    <title>Pythonic</title>
</head>
<body>
<div class="container">
    
<div class="row">
<div class="col">
    <h1>Test examples</h1>
    
        <h6>November  8, 2022</h6>
    
    <hr>
    <p>Example scripts are often available for Python packages to demonstrate how to use the package. The examples are typically part of the repository where the package is developed. Tests should be written to ensure the examples continue to work with new versions of the package.</p>
<p>Below is the structure of a project for developing a Python package. Notice the <code>examples</code> directory that contains example scripts for demonstrating functions from <code>mypackage</code>.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>myproject/
</span><span>├── README.md
</span><span>├── examples/
</span><span>│   ├── ex1.py
</span><span>│   └── ex2.py
</span><span>├── pyproject.toml
</span><span>├── src/
</span><span>│   └── mypackage/
</span><span>│       ├── __init__.py
</span><span>│       ├── adder.py
</span><span>│       └── divider.py
</span><span>└── tests/
</span><span>    ├── test_adder.py
</span><span>    ├── test_divider.py
</span><span>    ├── test_ex1.py
</span><span>    └── test_ex2.py
</span></code></pre>
<p>To ensure pytest can discover the examples, add the project to the Python path as shown below in the <code>pyproject.toml</code> file:</p>
<pre data-lang="toml" style="background-color:#2b303b;color:#c0c5ce;" class="language-toml "><code class="language-toml" data-lang="toml"><span>[tool.pytest.ini_options]
</span><span style="color:#bf616a;">pythonpath </span><span>= [&quot;</span><span style="color:#a3be8c;">.</span><span>&quot;]
</span></code></pre>
<p>The content of the first example is shown below along with the associated test. The test imports the example and asserts the value of the <code>a</code> variable.</p>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#65737e;"># Example 1 from examples/ex1.py
</span><span>
</span><span style="color:#b48ead;">from </span><span>mypackage </span><span style="color:#b48ead;">import </span><span>adder
</span><span>
</span><span>x = </span><span style="color:#d08770;">2.5
</span><span>y = </span><span style="color:#d08770;">8
</span><span>
</span><span>a = </span><span style="color:#bf616a;">adder</span><span>(x, y)
</span><span style="color:#96b5b4;">print</span><span>(&#39;</span><span style="color:#a3be8c;">a is</span><span>&#39;, a)
</span></code></pre>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#65737e;"># Test for example 1 from tests/test_ex1.py
</span><span>
</span><span style="color:#b48ead;">from </span><span>examples </span><span style="color:#b48ead;">import </span><span>ex1
</span><span>
</span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">test_ex1</span><span>():
</span><span>    a = ex1.a
</span><span>    </span><span style="color:#b48ead;">assert </span><span>a == </span><span style="color:#d08770;">10.5
</span></code></pre>
<p>The content of the second example is shown below along with the test. Unlike the previous example, this example contains all its code within functions. The test imports the example and asserts the returned value of the <code>run_divider()</code> function.</p>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#65737e;"># Example 2 from examples/ex2.py
</span><span>
</span><span style="color:#b48ead;">from </span><span>mypackage </span><span style="color:#b48ead;">import </span><span>divider
</span><span>
</span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">run_divider</span><span>():
</span><span>    x = </span><span style="color:#d08770;">4
</span><span>    y = </span><span style="color:#d08770;">9.2
</span><span>    d = </span><span style="color:#bf616a;">divider</span><span>(x, y)
</span><span>    </span><span style="color:#b48ead;">return </span><span>d
</span><span>
</span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">main</span><span>():
</span><span>    d = </span><span style="color:#bf616a;">run_divider</span><span>()
</span><span>    </span><span style="color:#96b5b4;">print</span><span>(&#39;</span><span style="color:#a3be8c;">d is</span><span>&#39;, d)
</span><span>
</span><span style="color:#b48ead;">if </span><span>__name__ == &#39;</span><span style="color:#a3be8c;">__main__</span><span>&#39;:
</span><span>    </span><span style="color:#bf616a;">main</span><span>()
</span></code></pre>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#65737e;"># Test for example 2 from tests/test_ex2.py
</span><span>
</span><span style="color:#b48ead;">from </span><span>examples </span><span style="color:#b48ead;">import </span><span>ex2
</span><span style="color:#b48ead;">import </span><span>pytest
</span><span>
</span><span style="color:#b48ead;">def </span><span style="color:#8fa1b3;">test_ex2</span><span>():
</span><span>    d = ex2.</span><span style="color:#bf616a;">run_divider</span><span>()
</span><span>    </span><span style="color:#b48ead;">assert </span><span>d == pytest.</span><span style="color:#bf616a;">approx</span><span>(</span><span style="color:#d08770;">0.4347</span><span>, </span><span style="color:#bf616a;">rel</span><span>=</span><span style="color:#d08770;">1e-3</span><span>)
</span></code></pre>

</div>
</div>
<div class="row my-5">
<div class="col">
    <p class="text-center small my-5">
        <a href="https://gavinw.me/pythonic/">Pythonic Programming</a> © 2023 <br>
        Built by <a href="https://gavinw.me">Gavin Wiggins</a>
    </p>
</div>
</div>

</div>
</body>
</html>